<!doctype html>
<html>
  <head>
    <link href="components/bootstrap/docs/assets/css/bootstrap.css" rel="stylesheet">
    <link href="compiled_css/main.css" rel="stylesheet">
  </head>
  <body>
    <!-- CHROME EXTENSION POPUP -->
    <script type="text/x-handlebars" data-template-name="application">
      <nav id="main-navigation">
        <ul class="nav nav-pills">
          <li>{{#linkTo timer}}Timer{{/linkTo}}</li>
          <li>{{#linkTo tasks}}Tasks{{/linkTo}}</li>
          <li>{{#linkTo today}}History{{/linkTo}}</li>
        </ul>
        <hr>
      </nav>
      <div>
        {{outlet}}
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="tasks">
      {{view App.AddTaskField placeholder="Add new task" class="input-block-level"}}

      <ul class="open-task-list task-list">
        {{#each task in controller.openTasks itemController="task"}}
          <li {{bindAttr class="isEditing:editing"}}>
            {{#if task.isEditing}}
              {{view App.EditTaskView taskBinding=task class="input-block-level"}}
            {{else}}
              {{input type=checkbox checked=task.isCompleted}}
              {{#linkTo task task}}{{task.title}}{{/linkTo}}
              <small><a class="edit-task-handle" href="#" {{action editTask task}}>edit</a></small>
            {{/if}}
          </li>
        {{/each}}
      </ul>

      <h5>
        Completed tasks
        <small>(<a {{action archiveTasks}} href="#">archive all completed</a>)</small>
      </h5>

      <ul class="completed-task-list task-list">
        {{#each task in completedTasks itemController="task"}}
          <li class="completed">
            {{input type=checkbox checked=task.isCompleted}}
            {{task.title}}
          </li>
        {{/each}}
      </ul>
    </script>

    <script type="text/x-handlebars" data-template-name="today">
      <div id="log-navigator">
        <button {{action showPrevious}} class="btn btn-small pull-left">
          <i class="icon-arrow-left"></i>
          Prev
        </button>
        <strong>{{monthDay day}}</strong>
        <button {{action showNext}} class="btn btn-small pull-right">
          <i class="icon-arrow-right"></i>
          Next
        </button>
      </div>
      <table class="table">
        <tr>
          <th>Started</th>
          <th>Finished</th>
          <th>Task</th>
          <th>Elapsed</th>
        </tr>
      {{#each completedLogs}}
        <tr>
          <td>{{time startedAt}}</td>
          <td>{{time finishedAt}}</td>
          <td>{{task.title}}</td>
          <td>{{duration elapsedSeconds}}</td>
        </tr>
      {{/each}}
      </table>
    </script>

    <script type="text/x-handlebars" data-template-name="task">
      <h4>{{title}} <small>({{id}})</small></h4>

      <table class="table">
        <tr>
          <th>Started</th>
          <th>Finished</th>
          <th>Elapsed</th>
        </tr>
      {{#each logs}}
        <tr>
          <td>{{time startedAt}}</td>
          <td>{{time finishedAt}}</td>
          <td>{{duration elapsedSeconds}}</td>
        </tr>
      {{/each}}
      </table>
    </script>

    <script type="text/x-handlebars" data-template-name="timer">
      <div id="timer-page">
      {{#if isRunning}}
        <h4 class="title">{{log.task.title}}</h4>
        <h2 class="timer">{{timer elapsedSeconds}}</h2>
        <hr>
        <button class="btn" {{action stopAndClose}}>Stop and close task</button>
        <button class="btn pull-right" {{action stop}}>Stop timer</button>
      {{else}}
        <p>Select the task you start working on</p>
        {{view App.TimerSelect contentBinding=openTasks
            selectionBinding=selectedTask
            optionValuePath=content.id
            optionLabelPath=content.title
            prompt="-- Please select a task --"
            class="input-block-level"}}
      {{/if}}
      </div>
    </script>

    <script src="components/jquery/jquery.js"></script>
    <script src="components/handlebars/handlebars.js"></script>
    <script src="components/ember/ember.js"></script>
    <script src="components/ember-data/index.js"></script>
    <script src="components/ember-localstorage/localstorage_adapter.js"></script>
    <script src="components/moment.js/moment.js"></script>
    <!-- build:js scripts/popup.js -->
    <script src="compiled_js/popup.js"></script>
    <!-- endbuild -->
  </body>
</html>
